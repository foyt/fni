<ui:composition 
  xmlns="http://www.w3.org/1999/xhtml" 
  xmlns:ui="http://java.sun.com/jsf/facelets" 
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:jsf="http://xmlns.jcp.org/jsf"
  xmlns:h="http://java.sun.com/jsf/html">

  <h:form>
    <div class="flex-row">
      <div class="flex-cell-full index-box">
        <div class="flex-row forge-list-header-row"> 
          <div class="flex-cell-13 flex-cell-first">  
            <h2>#{locales['forge.index.materialListTitle']}</h2>
          </div>
          <div class="flex-cell-3 flex-cell-last flex-right">  
            <h:commandLink action="#{forgeMaterialListsBackingBean.closeMaterialsList}" value="#{locales['forge.index.materialListClose']}"
              style="#{forgeMaterialListsBackingBean.materialsOpen ? '' : 'display: none'}" />
            <h:commandLink action="#{forgeMaterialListsBackingBean.openMaterialsList}" value="#{locales['forge.index.materialListOpen']}"
              style="#{!forgeMaterialListsBackingBean.materialsOpen ? '' : 'display: none'}" />
          </div>
        </div>
        
        <div class="flex-row" jsf:rendered="#{forgeMaterialListsBackingBean.materialsOpen}"> 
          <ui:repeat var="material" value="#{materials}">
            <div class="lg-flex-cell12-4 md-flex-cell12-4 sm-flex-cell-full">
              <ui:include src="/facelets/forgematerial.xhtml">
                <ui:param name="material" value="#{material}" />
              </ui:include>
            </div>
          </ui:repeat>
        </div>
        
        <div class="flex-row"> 
          <div class="lg-flex-cell12-4 lg-flex-cell12-first md-flex-cell12-4 md-flex-cell12-first sm-flex-cell-full">  
            <div class="flex-row forge-list-header-row"> 
              <div class="flex-cell-12 flex-cell-first">  
                <h2>#{locales['forge.index.starredListTitle']}</h2>
              </div>
              <div class="flex-cell-4 flex-cell-last flex-right">  
                <h:commandLink action="#{forgeMaterialListsBackingBean.closeStarredList}" value="#{locales['forge.index.starredClose']}" style="#{forgeMaterialListsBackingBean.starredOpen ? '' : 'display: none'}" />
                <h:commandLink action="#{forgeMaterialListsBackingBean.openStarredList}" value="#{locales['forge.index.starredOpen']}" style="#{!forgeMaterialListsBackingBean.starredOpen ? '' : 'display: none'}" />
              </div>
            </div>
            
            <div class="flex-row" jsf:rendered="#{forgeMaterialListsBackingBean.starredOpen}"> 
              <div class="flex-cell-full">
                <ui:repeat var="material" value="#{starredMaterials}">
                  <ui:include src="/facelets/forgematerial.xhtml">
                    <ui:param name="material" value="#{material}" />
                  </ui:include>
                </ui:repeat>
              </div>
            </div>
          </div>
        
          <div class="lg-flex-cell12-4 md-flex-cell12-4 sm-flex-cell-full">  
            <div class="flex-row forge-list-header-row"> 
              <div class="flex-cell-12 flex-cell-first">  
                <h2>#{locales['forge.index.lastViewedListTitle']}</h2>
              </div>
              <div class="flex-cell-4 flex-cell-last flex-right">  
                <h:commandLink action="#{forgeMaterialListsBackingBean.closeLastViewedList}" value="#{locales['forge.index.lastViewedClose']}"
                  style="#{forgeMaterialListsBackingBean.lastViewedOpen ? '' : 'display: none'}" />
                <h:commandLink action="#{forgeMaterialListsBackingBean.openLastViewedList}" value="#{locales['forge.index.lastViewedOpen']}"
                  style="#{!forgeMaterialListsBackingBean.lastViewedOpen ? '' : 'display: none'}" />
              </div>
            </div>
            
            <div class="flex-row" jsf:rendered="#{forgeMaterialListsBackingBean.lastViewedOpen}"> 
              <div class="flex-cell-full">
                <ui:repeat var="material" value="#{lastViewedMaterials}">
                  <ui:include src="/facelets/forgematerial.xhtml">
                    <ui:param name="material" value="#{material}" />
                  </ui:include>
                </ui:repeat>
              </div>
            </div>
          </div>

          <div class="lg-flex-cell12-4  lg-flex-cell12-last md-flex-cell12-4 md-flex-cell12-last sm-flex-cell-full">  
            <div class="flex-row forge-list-header-row"> 
              <div class="flex-cell-12 flex-cell-first">  
                <h2>#{locales['forge.index.lastEditedListTitle']}</h2>
              </div>
              <div class="flex-cell-4 flex-cell-last flex-right">  
                <h:commandLink action="#{forgeMaterialListsBackingBean.closeLastEditedList}" value="#{locales['forge.index.lastEditedClose']}"
                  style="#{forgeMaterialListsBackingBean.lastEditedOpen ? '' : 'display: none'}" />
                <h:commandLink action="#{forgeMaterialListsBackingBean.openLastEditedList}" value="#{locales['forge.index.lastEditedOpen']}"
                  style="#{!forgeMaterialListsBackingBean.lastEditedOpen ? '' : 'display: none'}" />
              </div>
            </div>
            
            <div class="flex-row" jsf:rendered="#{forgeMaterialListsBackingBean.lastEditedOpen}"> 
              <div class="flex-cell-full">
                <ui:repeat var="material" value="#{lastEditedMaterials}">
                  <ui:include src="/facelets/forgematerial.xhtml">
                    <ui:param name="material" value="#{material}" />
                  </ui:include>
                </ui:repeat>
              </div>
            </div>
          </div>
        </div> 
        
                
      </div>
    </div>
    
    <h:inputHidden value="#{materialsOpen}" />
    <h:inputHidden value="#{lastViewedOpen}" />
    <h:inputHidden value="#{lastEditedOpen}" />
    <h:inputHidden value="#{starredOpen}" />
  </h:form>

  <h:panelGroup layout="block" id="forge-action-form-container" style="display: none">
    <h:form>
      <h:inputHidden id="material-id" value="#{forgeMaterialActionBackingBean.materialId}" />
      <h:inputHidden id="parent-folder-id" value="#{forgeMaterialActionBackingBean.parentFolderId}" />
      <h:inputHidden id="target-folder-id" value="#{forgeMaterialActionBackingBean.targetFolderId}" />
      <h:inputHidden id="material-share-publicity" value="#{forgeMaterialActionBackingBean.materialSharePublicity}" />
      <h:inputHidden id="material-share-collaborators" value="#{forgeMaterialActionBackingBean.materialShareCollaborators}" converter="fi.foyt.fni.jsf.JsonMapConverter" />
      <h:inputHidden id="material-share-tags" value="#{forgeMaterialActionBackingBean.materialShareTags}" />
      <h:inputHidden id="material-share-description" value="#{forgeMaterialActionBackingBean.materialShareDescription}" />
      <h:inputHidden id="material-share-license" value="#{forgeMaterialActionBackingBean.materialShareLicense}" />
      <h:inputHidden id="new-folder-name" value="#{forgeMaterialActionBackingBean.newFolderName}" />
      <h:commandButton id="delete" action="#{forgeMaterialActionBackingBean.deleteMaterial}" />
      <h:commandButton id="move" action="#{forgeMaterialActionBackingBean.moveMaterial}" />
      <h:commandButton id="print-file" action="#{forgeMaterialActionBackingBean.printFile}" />
      <h:commandButton id="material-share-save" action="#{forgeMaterialActionBackingBean.materialShareSave}" />
      <h:commandButton id="new-folder" action="#{forgeMaterialActionBackingBean.newFolder}" />
      <h:commandButton id="copy" action="#{forgeMaterialActionBackingBean.copyMaterial}" />
    </h:form>
  </h:panelGroup>

</ui:composition>